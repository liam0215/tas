#!/usr/bin/gnuplot -persist
set terminal pdf
set output "plot.pdf"
set colorsequence podo
set key autotitle columnhead
set key left top

# margins: left,right,bottom,top
# spacing: xspacing,yspacing
set multiplot layout 2,2 \
              margins 0.1,0.95,0.15,0.90 \
              spacing 0.1,0.07
              
set label 1 "# Connections" at screen 0.5, 0.03 center
set label 2 "Latency (Âµs)" at screen 0.01, 0.5 rotate by 90 center

set title offset 0,-0.6

# Plot 50p latency
unset xtics
set yrange [0:]
set title "50p Latency"
plot 'lat_50p.dat' using 1:2 title 'bare-tas' linetype 2 w lp, \
     'lat_50p.dat' using 1:3 title 'bare-vtas' linetype 3 w lp, \
     'lat_50p.dat' using 1:4 title 'virt-tas' linetype 4 w lp, \

# Plot 90p latency
unset xtics
set yrange [0:]
set title "90p Latency"
plot 'lat_90p.dat' using 1:2 title 'bare-tas' linetype 2 w lp, \
     'lat_90p.dat' using 1:3 title 'bare-vtas' linetype 3 w lp, \
     'lat_90p.dat' using 1:4 title 'virt-tas' linetype 4 w lp, \

# Plot 99p latency
set xtics
set yrange [0:]
set title "99p Latency"
plot 'lat_99p.dat' using 1:2:xtic(1) title 'bare-tas' linetype 2 w lp, \
     'lat_99p.dat' using 1:3:xtic(1) title 'bare-vtas' linetype 3 w lp, \
     'lat_99p.dat' using 1:4:xtic(1) title 'virt-tas' linetype 4 w lp, \

# Plot 99.9p latency
set xtics
set yrange [0:]
set title "99.9p Latency"
plot 'lat_99.9p.dat' using 1:2:xtic(1) title 'bare-tas' linetype 2 w lp, \
     'lat_99.9p.dat' using 1:3:xtic(1) title 'bare-vtas' linetype 3 w lp, \
     'lat_99.9p.dat' using 1:4:xtic(1) title 'virt-tas' linetype 4 w lp, \
